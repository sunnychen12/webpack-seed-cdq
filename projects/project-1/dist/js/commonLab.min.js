var commomLab={whichTransitionEvent:function(){var e,t=document.createElement("surface"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(void 0!==t.style[e])return n[e]},checkform:function(e){var a=this,o=!0;return $('[data-check="1"]',e).each(function(e,t){var n=this;return""==$.trim($(this).val())?(a.myToast({msg:$(this).attr("data-msg-empty")},function(){$(n).focus()}),o=!1):new RegExp($(this).attr("data-rule"),"g").test($(this).val())?void 0:(a.myToast({msg:$(this).attr("data-msg-error")},function(){$(n).focus()}),o=!1)}),o},moveTop:function(e){var t=$("#movetop");0==t.length&&($("body").append('<a href="javascript:;" class="moveTop" id="movetop"></a>'),t=$("#movetop")),t.click(function(){e.scrollTop(0)});var n=e;n.on("scroll",function(e){50<n.scrollTop()?t.animate({opacity:1},"fast","ease",function(){t.show()}):t.animate({opacity:0},"fast","ease",function(){t.hide()})})},myToast:function(e,t){e=$.extend({},{msg:"",time:2e3,extraclass:""},e),$("body").append($('<div data-id="my-overlay"></div>').css({position:"absolute",left:0,top:0,"z-index":10600,width:"100%",height:"100%"}));var n=$('<div class="modal toast '+(e.extraclass||"")+'">'+e.msg+"</div>").appendTo(document.body);$.openModal(n,function(){setTimeout(function(){n.one("closed",function(e){$('[data-id="my-overlay"]').remove(),"function"==typeof t&&t.call()}),$.closeModal(n)},e.time)})},getQueryParam:function(e){var t=window.location.href,n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=t.indexOf("?");if(-1==a)return null;var o=t.substr(a+1).match(n);return null!=o?decodeURIComponent(o[2]):null},ajaxProcess:function(e){if(e.type||(e.type="GET"),e.dataType||(e.dataType="json"),"boolean"==typeof e.cache||(e.cache=!1),"/api/stud/study/moodleGetUserCourseInfo"!=e.url){var t=this.cacheUserCourseInfo.get();t&&e.data&&(e.data.domainName=t.user.domainName)}var n=$.extend({},$.ajaxSettings,e);return $.ajax(n)},cacheUserCourseInfo:{key:"UserCourseInfo",clear:function(){localStorage.removeItem(this.key)},set:function(e){localStorage.setItem(this.key,JSON.stringify(e))},get:function(){var e=!1;try{e=JSON.parse(localStorage.getItem(this.key))}catch(e){}return e}},cacheCourseInfoActivities:{key:"courseActivities",clear:function(){sessionStorage.removeItem(this.key)},set:function(e){sessionStorage.setItem(this.key,JSON.stringify(e))},get:function(){var e=!1;try{e=JSON.parse(sessionStorage.getItem(this.key))}catch(e){}return e}},getActivityInfo:function(t){var e=this.cacheCourseInfoActivities.get().allModules.filter(function(e){return t==e.id})[0];return e||!1},cacheIndexScrollPos:{key:"indexScrollPos",clear:function(){sessionStorage.removeItem(this.key)},set:function(e){sessionStorage.setItem(this.key,e)},get:function(){return sessionStorage.getItem(this.key)}},cacheAttemptState:{para:{qid:"-",aid:"-"},key:"attemptState",clear:function(e){var t=this.key+""+e.qid+"_"+e.aid;sessionStorage.removeItem(t)},set:function(e,t){var n=this.key+""+e.qid+"_"+e.aid;sessionStorage.setItem(n,t)},get:function(e){var t=this.key+""+e.qid+"_"+e.aid;return sessionStorage.getItem(t)}},checkAPIResult:function(e){return 200==e.msgCode&&e.data},callTeacher:function(){try{var e=this.cacheUserCourseInfo.get().user;e&&e.username&&e.studentId&&(location.href="/statics/mobile-learning/faq-center.html?userName="+e.username+"&studentId="+e.studentId)}catch(e){}},onPageBackAway:function(e){history.replaceState(null,null,"#t0"),window.onhashchange=function(){"function"==typeof e&&e.call(window)}},addStudyAction:function(e){var t=this.cacheUserCourseInfo.get(),n={C001:"进入课程",C002:"文本学习",C003:"视频学习",C004:"进入测试",C005:" 进入测验做题",C006:" 提交测验做题",C007:" 进入讨论活动",C008:" 讨论发表回复",C009:" 讨论发表评论"},a={userNo:t.user.username,courseCode:t.course.courseCode,actId:"",actTime:0,actType:"",actName:"",actDec:"",timeStamp:"",nonce:"",signature:""};e.actType&&n[e.actType]&&(e.actDec||(e.actDec="“"+e.actName+"”"+n[e.actType])),e=$.extend({},a,e),this.ajaxProcess({url:"/api/stud/online/addStudyAction.json",data:e})},floatToFixed:function(e,t){if(t||(t=0),-1==(n=e+"").indexOf(".")&&(n+="."),n+=new Array(t+1).join("0"),new RegExp("^(-|\\+)?(\\d+(\\.\\d{0,"+(t+1)+"})?)\\d*$").test(n)){var n="0"+RegExp.$2,a=RegExp.$1,o=RegExp.$3.length,i=!0;if(o==t+2){if(o=n.match(/\d/g),4<parseInt(o[o.length-1]))for(var s=o.length-2;0<=s&&(o[s]=parseInt(o[s])+1,10==o[s]);s--)o[s]=0,i=1!=s;n=o.join("").replace(new RegExp("(\\d+)(\\d{"+t+"})\\d$"),"$1.$2")}return i&&(n=n.substr(1)),(a+n).replace(/\.$/,"")}return e+""},faqDefaultParams:{userName:"",studentId:"",signature:"feedgrrbackiktlsignaturewldpmo"}};$.fn.fadeIn=function(t){return this.each(function(){var e=$(this);e.addClass("fadeIn animated").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.removeClass("fadeIn animated"),"function"==typeof t&&t.call(e)}).show()})},$.fn.slideToggle=function(n){return this.each(function(){var t=$(this);if(!t.hasClass("animating")){var e=t.children(".slide-cnt").height();t.addClass("animating"),t.hasClass("expand")?t.height(e).height(0):t.height(e),t.one(commomLab.whichTransitionEvent(),function(e){t.hasClass("expand")?t.removeClass("expand"):t.addClass("expand"),t.removeClass("animating"),"function"==typeof n&&n.call(t)})}})},/Android/gi.test(navigator.userAgent)&&window.addEventListener("resize",function(){"INPUT"!=document.activeElement.tagName&&"TEXTAREA"!=document.activeElement.tagName||window.setTimeout(function(){document.activeElement.scrollIntoViewIfNeeded()},0)}),String.prototype.format=function(){var n=arguments;return this.replace(/\{(\d+)\}/g,function(e,t){return n[t]})};