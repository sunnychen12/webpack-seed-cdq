<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>报读易优化_缴费成功-完善个人学籍资料（默认页）</title>
	<meta name="viewport" content="initial-scale=1, maximum-scale=1">
	<link rel="shortcut icon" href="/favicon.ico">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta content="telephone=no" name="format-detection">
	<meta content="email=no" name="format-detection">
	<link rel="stylesheet" type="text/css" href="css/common.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	
</head>
<body>
	<div class="page-group">
		<div class="page page-current">
			<div class="bar bar-footer-btn">
			  <div class="media full-height">
			  	<div class="media-body">
			  		<button type="button" class="button button-big button-fill button-danger full-width">提交</button>
			  	</div>
			  </div>
			</div>
			<div class="content">

				<div class="form-content">
					<div class="form-block">
						<div class="form-block-title flex-box flex-box-justify flex-align-center">
							<b>电子版免冠一寸蓝底证件照</b>
							<div class="gray6 as-link" data-target="#view-sample-1-tpl" data-view="sample">
					      		<span class="inline-block vertical-middle">查看样例</span>
					      		<span class="icon icon-right font_5rem"></span>
					      	</div>
						</div>
						<div class="margin-t_7rem flex-box flex-box-justify flex-align-center">
							<div class="embed-responsive img-oper-wrap img-oper-wrap-v">
								<div class="embed-responsive-item">
									<div class="img-oper-box">
										<!--
										<img src="images/per.jpg?b184d" class="img-oper">
										-->
										<div class="img-oper-holder flex-box flex-vertical flex-align-center flex-box-justify-center">
											<i class="im-w"></i>
									    	<div class="u-tips">
									      		<span class="u-txt11">点击上传</span>
									      		<span class="u-txt12">点击更改</span>
									    	</div>
										</div>
										<input class="file-path" type="hidden">
									</div>
								</div>
							</div>
							<div class="gray font_65rem flex-item text-center">
								请按样例中的要求上传你的<br>电子版免冠一寸蓝底证件照
							</div>
						</div>
					</div>
					<div class="form-block">
						<div class="form-block-title flex-box flex-box-justify flex-align-center">
							<b>身份证原件正反面扫描件</b>
							<div class="gray6 as-link" data-target="#view-sample-2-tpl" data-view="sample">
					      		<span class="inline-block vertical-middle">查看样例</span>
					      		<span class="icon icon-right font_5rem"></span>
					      	</div>
						</div>
						<div class="list-cutstom">
							<label class="list-cutstom-item flex-box flex-align-center as-link">
								<div class="margin-r_5rem">
									<div class="checkbox-group radio-group">
										<input type="radio" class="checkbox-control" name="r1" checked>
										<span class="checkbox-icon">
											<i class="icomoon">&#xe901;</i>
										</span>
									</div>
								</div>
								<div class="flex-item line-height-1">
									<div class="font_75rem text-bold">中国居民身份证</div>
								</div>
							</label>
							<label class="list-cutstom-item flex-box flex-align-center as-link">
								<div class="margin-r_5rem">
									<div class="checkbox-group radio-group">
										<input type="radio" class="checkbox-control" name="r1">
										<span class="checkbox-icon">
											<i class="icomoon">&#xe901;</i>
										</span>
									</div>
								</div>
								<div class="flex-item line-height-1">
									<div class="font_75rem text-bold">其它身份证件</div>
									<div class="font_6rem gray9 margin-t_5rem">（中国居民临时身份证，港澳台、外籍人士身份证）</div>
								</div>
							</label>
						</div>
						<div class="margin-t_7rem flex-box flex-box-justify flex-align-center">
							<div class="embed-responsive img-oper-wrap flex-item">
								<div class="embed-responsive-item">
									<div class="img-oper-box">
										<!--
										<img src="images/per.jpg?b184d" class="img-oper">
										-->
										<div class="img-oper-holder flex-box flex-vertical flex-align-center flex-box-justify-center">
											<i class="im-w"></i>
									    	<div class="u-tips">
									      		<span class="u-txt11">点击上传</span>
									      		<span class="u-txt12">点击更改</span>
									    	</div>
										</div>
										<input class="file-path" type="hidden">
									</div>
								</div>
							</div>
							<div class="embed-responsive img-oper-wrap flex-item margin-l-1rem">
								<div class="embed-responsive-item">
									<div class="img-oper-box">
										<!--
										<img src="images/per.jpg?b184d" class="img-oper">
										-->
										<div class="img-oper-holder flex-box flex-vertical flex-align-center flex-box-justify-center">
											<i class="im-w"></i>
									    	<div class="u-tips">
									      		<span class="u-txt11">点击上传</span>
									      		<span class="u-txt12">点击更改</span>
									    	</div>
										</div>
										<input class="file-path" type="hidden">
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="form-block">
						<div class="form-block-title flex-box flex-box-justify flex-align-center">
							<b>高中或职高、中专、技校毕业证书</b>
							<div class="gray6 as-link" data-target="#view-sample-3-tpl" data-view="sample">
					      		<span class="inline-block vertical-middle">查看样例</span>
					      		<span class="icon icon-right font_5rem"></span>
					      	</div>
						</div>
						<div class="margin-t_7rem flex-box flex-box-justify flex-align-center">
							<div class="embed-responsive img-oper-wrap flex-item" style="padding-bottom: 55%;">
								<div class="embed-responsive-item">
									<div class="img-oper-box">
										<!--
										<img src="images/per.jpg?b184d" class="img-oper">
										-->
										<div class="img-oper-holder flex-box flex-vertical flex-align-center flex-box-justify-center">
											<i class="im-w"></i>
									    	<div class="u-tips">
									      		<span class="u-txt11">点击上传</span>
									      		<span class="u-txt12">点击更改</span>
									    	</div>
										</div>
										<input class="file-path" type="hidden">
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="form-block">
						<div class="form-block-title flex-box flex-box-justify flex-align-center">
							<b>企业工作证明</b>
							<div class="gray6 as-link" data-target="#view-sample-4-tpl" data-view="sample">
					      		<span class="inline-block vertical-middle">查看样例</span>
					      		<span class="icon icon-right font_5rem"></span>
					      	</div>
						</div>
						<div class="margin-t_7rem flex-box flex-box-justify flex-align-center">
							<div class="embed-responsive img-oper-wrap flex-item" style="padding-bottom: 55%;">
								<div class="embed-responsive-item">
									<div class="img-oper-box">
										<!--
										<img src="images/per.jpg?b184d" class="img-oper">
										-->
										<div class="img-oper-holder flex-box flex-vertical flex-align-center flex-box-justify-center">
											<i class="im-w"></i>
									    	<div class="u-tips">
									      		<span class="u-txt11">点击上传</span>
									      		<span class="u-txt12">点击更改</span>
									    	</div>
										</div>
										<input class="file-path" type="hidden">
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="form-block">
						<div class="form-block-title">
							<b>签字确认</b>
						</div>
						<div class="margin-t_7rem flex-box flex-box-justify flex-align-center sign-btn-group gray-box">
							<div class="flex-item" id="preview-box">

							</div>
							<div class="margin-l_5rem">
								<button type="button" class="button sign-btn sign-btn-reset">重签</button>
							</div>
							<div class="margin-l_5rem">
								<button type="button" class="button sign-btn sign-btn-confirm">确认</button>
							</div>
						</div>
						<div class="margin-t_7rem gray-box signature-area">
							<div class="embed-responsive" style="padding-bottom: 74%;">
								<div class="embed-responsive-item">
									<div id="signature" class="signature"></div>	

									<div class="tips gray font_75rem">请在上方签上您的姓名全称</div>

									<div class="signature-mark" style="display:none;">
										<div class="full-height flex-box flex-vertical flex-align-center flex-box-justify-center">
											<div>
												如需重签请点击“重签一次”
											</div>
										</div>
						            </div>
								</div>
							</div>
						</div>
						<div class="margin-t_7rem">
							<label class="flex-box flex-align-center">
								<div class="checkbox-group radio-group margin-r_5rem">
									<input type="checkbox" class="checkbox-control" name="ck1" id="promise-true">
									<span class="checkbox-icon">
										<i class="icomoon">&#xe901;</i>
									</span>
								</div>
								<div class="flex-item font_65rem gray9">
									我承诺及确认以上信息正确无误并保证其真实性
								</div>
							</label>
							
						</div>
						<ul class="list-unstyled font_65rem gray9 sign-tips-panel">
							<li>1、签名必须是您的姓名全称</li>
							<li>2、签名尽量连贯写完，不要逐字书写，避免无法签完姓名全称<li>
						</ul>
					</div>
				</div>
				<div class="text-center font_75rem gray" style="margin:1rem 0;">
					主办：连锁经营实验学院
				</div>
			</div>
		</div>
	</div>	<script type="text/javascript" src="http://css.gzedu.com/common/js/jquery-1.7.2.min.js"></script>
	<script type="text/javascript">jQuery.noConflict();</script>
	<script type="text/javascript" src="js/common.js"></script>
	<script type="text/javascript" src="js/commonLab.js"></script>
<script type="text/javascript" src="assets/js/jSignature.min.noconflict.js"></script>

<script type="text/javascript" src="assets/js/cropper.min.js"></script>

<!--电子版免冠一寸蓝底证件照（样例）-->
<script type="text/template" id="view-sample-1-tpl">
	<div class="modal-content bg-white">
		<div class="text-center margin-t_5rem">
			<div class="embed-responsive center-block" style="width: 55%;padding-bottom:80%;">
				<img class="embed-responsive-item border" src="images/per.png?d6592" data-large-img="images/per.png?d6592" title="电子版免冠一寸蓝底证件照（样例）" >
			</div>
			<h4 class="font_75rem padding-t_5rem">电子版免冠一寸蓝底证件照（样例）</h4>
		</div>
	</div>
</script>

<!--身份证原件-->
<script type="text/template" id="view-sample-2-tpl">
	<div class="modal-content bg-white">
		<div class="text-center margin-t_5rem">
			<div class="embed-responsive center-block" style="width: 80%;padding-bottom:50%;">
				<img class="embed-responsive-item border" src="images/sample1.png?17824" data-large-img="images/sample1.png?17824" title="身份证原件正面（样例）">
			</div>
			<h4 class="font_75rem padding-t_5rem">身份证原件正面（样例）</h4>

			<div class="embed-responsive center-block margin-t_7rem" style="width: 80%;padding-bottom:50%;">
				<img class="embed-responsive-item border" src="images/sample2.png?d5af1" data-large-img="images/sample2.png?d5af1" title="身份证原件反面（样例）">
			</div>
			<h4 class="font_75rem padding-t_5rem">身份证原件反面（样例）</h4>
		</div>
	</div>
</script>

<!--毕业证书-->
<script type="text/template" id="view-sample-3-tpl">
	<div class="modal-content bg-white">
		<div class="text-center margin-t_5rem">
			<div class="embed-responsive center-block" style="width: 80%;padding-bottom:50%;">
				<img class="embed-responsive-item border" src="images/sample3.png?4fd93" data-large-img="images/sample3.png?4fd93" title="高中或职高、中专、技校毕业证书（样例）">
			</div>
			<h4 class="font_75rem padding-t_5rem">高中或职高、中专、技校毕业证书（样例）</h4>
		</div>
	</div>
</script>

<!--企业工作证明-->
<script type="text/template" id="view-sample-4-tpl">
	<div class="modal-content bg-white">
		<div class="text-center margin-t_5rem">
			<div class="embed-responsive center-block" style="width: 80%;padding-bottom:50%;">
				<img class="embed-responsive-item border" src="images/sample4.png?56cfc" data-large-img="images/sample4.png?56cfc" title="企业工作证明（样例）">
			</div>
			<h4 class="font_75rem padding-t_5rem">企业工作证明（样例）</h4>
		</div>
	</div>
</script>

<script type="text/template" id="upload-pic-pop-tpl">
	<div class="modal-content bg-white padding-top-none">
		<div class="img-process-container">
	      <span class="preloader" style="display:none;"></span>
	    </div>
	    <div class="clearfix margin-t_5rem">
		    <div class="position-relative sel-img pull-left">
		        <a href="javascript:void(0)" id="sel-pic" class="external button">选择图片</a>
		    </div>
		    <div class="upload-controller">
		      <span class="icon icon-reset"></span>
		      <span class="icon icon-rotate-right"></span>
		    </div>
		</div>
		<div class="row clearfix margin-t-1rem">
		    <div class="col-50">
		        <button class="button button-fill button-md full-width" data-role="cancel" onclick="$.closeModal();">取消</button>
		    </div>
		    <div class="col-50">
		        <button data-role="sure-cropper" class="button button-fill button-md full-width">
		          <span class="text">确定</span>
		          <span class="preloader" style="display:none;width: .9rem;height: .9rem;"></span></button> 
		    </div>
		</div>
	</div>
</script>

<!--图片提交模板-->
<script type="text/html" id="h-tmp">
  <html>
  <head>
  </head>
  <body>
  <form id="submitForm" name="submitForm" method="post" enctype="multipart/form-data" action="http://eefile.gzedu.com/ossupload/uploadInterface.do">
    <input type="file" name="files" id="file" accept="image/jpg">    
    <input type="hidden" name="formMap.FILE_TYPE" value="files">

    <input type="hidden" name="formMap.compress" value="0">

    <input type="hidden" name="formMap.origin" value="{{basePath}}/assets/html/uploadIframe.html">
    <input type="hidden" name="formMap.filecwd" value="/APP038/xj/image">
    <input type="hidden" name="formMap.ACCESS_KEY_ID" value="b49ca70bac1082b01318bd3cecf317e4">
    <input type="hidden" name="formMap.ACCESS_KEY_SECRET" value="17b16aedf2f46e32ccfbd6049090925f">
  </form>
  </body>
  </html>
</script>
<script type="text/javascript">
	//签名功能
	;(function($){
		var $signature=$("#signature")
			, $signatureMark=$(".signature-mark")
			, $confirm = $('.sign-btn-confirm')
			, $previewBox = $('#preview-box')
			, $promise = $('#promise-true');
		//初始化签名插件
		$signature.jSignature({
		    width : '100%',
		    height : '100%'
		});

		//重新签名
		$(".sign-btn-reset").click(function(){
		    //var $signArea=$("#signature");
		    $signature.jSignature("enable");

		    $signatureMark.hide();

		    $confirm.prop('disabled', false);

		    $previewBox.empty();

		    $promise.prop('checked',false);

		    $signature.jSignature("reset");
		});

		//确认签名
		$confirm.click(function(){
				if(!$promise.prop('checked')){
					Zepto.toast('请勾选我承诺信息的真实性');

					return false;
				}

		      	var base30 =$signature.jSignature("getData", "base30");

		      	if(base30 && base30.length==2 && base30[1]==""){
		        	Zepto.toast('请签名');

		        	return false;
		      	}
		      	else{
			      	$(this).prop('disabled', true);

			      	$signatureMark.show();

			        //待提交数据
			        var imageData=addSign();

			        var img = '<img class="preview-image" src="'+imageData+'" />';

					$previewBox.html(img);

			        //擦除签名面板
			        $signature.jSignature("reset");
		      	}
		});

		//将写字板的内容添加至展示区
		function addSign(){
		    var src='';
		    //var $signArea=$("#signature");
		    var data = $signature.jSignature("getData", "image");
		    if(data && data.length > 1){
		      src = "data:" + data[0] + "," + data[1];
		      $signature.jSignature("disable");
		    }

		    return src;
		}

	})(jQuery);

	/*完善证件资料*/
	;(function($){

	    //图片回调处理方法（跨域上传图片时，图片上传后需要调用的方法）
	    window.imgCallback=function(ajaxFilelist){

	      if(ajaxFilelist){
	        var path=ajaxFilelist.resultList[0].FILE_PATH;

	        var $loader=$('.img-process-container > .preloader').show();

	        //checkImgSize(path,function(){

	          var url=path+'?x-oss-process=image/resize,h_4000,w_4000/auto-orient,1';

	          controlBusiness(url);
	          
	          $('[data-role="sure-cropper"]').removeClass('disabled').prop('disabled',false)
	                    .children('.preloader').hide().siblings('.text').text('确定');

	        //});
	      }
	    }

	    //图片上传成功后，处理逻辑
	    window.controlBusiness=function(url){
	      var $imgContainer=$('.img-process-container');
	      var $img=$('.process-image');

	      if($img.length<=0){
	        $imgContainer.append('<img class="process-image" src="'+url+'">');
	        imgCropper();
	      }
	      else{
	        $img.attr('src',url).cropper('replace',url);
	      }
	      $('.preloader',$imgContainer).show();
	    }    

	    //图片裁切初使化
	    window.imgCropper=function (){
	      var $img=$('.process-image');
	      var $loader=$('.img-process-container > .preloader');

	      if($img.length<=0 && !$img.attr('src')) return;
	      $loader.show();
	      $img.cropper({
	        //checkImageOrigin:false,
	        crop: function(data) {
	          // 出来裁切后的图片数据.
	          var param='/rotate,{0}/crop,x_{1},y_{2},w_{3},h_{4}/{5}';
	          param=param.format(
	            Math.round(data.rotate),
	            Math.round(data.x),
	            Math.round(data.y),
	            Math.round(data.width),
	            Math.round(data.height),
	            (param.indexOf('resize,h_4000,w_4000/auto-orient,1')==-1?'resize,h_4000,w_4000/auto-orient,1':'')
	          );

	          $img.attr('data-crop-param',param);
	        },
	        build:function(){
	          $loader.show();
	        },
	        built:function () {
	          $loader.hide();
	        }
	      });
	    };

	    //动态创建iframe上传文件
	    window.createUploadIframe=function (){
	      var ifrm=$('#ifr');
	      if(ifrm){
	        ifrm.remove();
	      }
	      $('body').append('<iframe id="ifr" name="ifr" src="about:blank" style="display:none;"></iframe>');
	      ifrm=document.getElementById('ifr');
	      var doc=ifrm.contentWindow.document;

	      doc.open();
	      doc.write(
	      		$('#h-tmp').html().replace('{{basePath}}',location.protocol+'//'+location.host)
	      );
	      doc.close();

	      //显示图片
	      $(ifrm.contentWindow.document).find('#file').on('change', function(event) {
	        event.preventDefault();

	        $('[data-role="sure-cropper"]').addClass('disabled').prop('disabled',true)
	                  .children('.preloader').show().siblings('.text').text('图片上传中');

	        var ifrm=document.getElementById('ifr');
	        var doc=ifrm.contentWindow.document;
	        
	        doc.forms.submitForm.submit();
	      });
	    }

	})(jQuery);

	//点击上传图片
    $('.img-oper-box').click(function(event) {
        $('.img-oper-box').removeClass('actived');
        $(this).addClass('actived');

        var imgURL=$(this).find('.file-path').val()

        var $domModal=commonLab.openModal({
	    	title: '图片上传',
	    	text: $('#upload-pic-pop-tpl').html(),
	    	extraClass: 'my-modal my-modal-2 upload-pic-pop'
	    });

	    //清除生成的动态表单
      	$domModal.find('.icon-close,[data-role="cancel"]').on('click', function(event) {
	        var ifrm=$('#ifr');
	        if(ifrm){
	          ifrm.remove();
	        }
      	});

	    ;(function($){
	        var $uploadPop=$('.upload-pic-pop');

	        if(imgURL!=''){
	          controlBusiness(imgURL);
	        }

	        //动态创建iframe图片上传框
	        createUploadIframe();

	        $('.upload-pic-pop')
	        //重置
	        .on('click', '.icon-reset', function(event) {
	          	$('.process-image').cropper('reset');
	        })

	        //向右旋转
	        .on('click', '.icon-rotate-right', function(event) {
	          	$('.process-image').cropper('rotate', 45);
	        })

	        //选择图片
	        .on('click', '#sel-pic', function(event) {
	        	createUploadIframe();
	            $('#ifr').contents().find("#file").trigger('click');
	        })

	        //确定裁切图片
	        .on('click', '[data-role="sure-cropper"]', function(event) {
	            var $img=$('.process-image');
	            if($img.length>0){
	              
	              $img.cropper('disable');

	              var $box=$('.img-oper-box.actived');
	              var $loadImg=$box.find('img');
	              var src=$img.attr('src');
	              //src=src.replace(/\/resize,h_4000,w_4000\/auto-orient,1/g,'');
	              var url=src+$img.attr('data-crop-param');

	              if($loadImg.length<=0){
	                $box.find('.img-oper-holder').before('<img src="'+url+'" class="img-oper">');
	                $loadImg=$box.find('img');                
	              }

	              $loadImg.attr('src',url);

	              $box.find('.file-path').val(url).attr('data-change-val','true');

	              $(this).addClass('disabled').prop('disabled',true)
	                  .children('.preloader').show().siblings('.text').text('图片处理中');

	              $loadImg.on('load', function() {
	                  Zepto.closeModal();
	              });
	            }
	            else{
	              Zepto.closeModal();
	            }
	        });

	    })(jQuery);
    });

	//查看样例
	$('[data-view="sample"]').on('click', function(event) {
		var title = $(this).data('title')
			, target = $(this).data('target');
		var $modal = commonLab.openModal({
	    	title: title?title:'查看样例',
	    	text: $(target).html()
	    });

	    commonLab.showLargePhoto($modal.find('img'));
	});
</script>


</body>
</html>